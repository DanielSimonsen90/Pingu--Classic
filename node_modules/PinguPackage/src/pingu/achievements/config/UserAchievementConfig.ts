import { UserAchievement, UserAchievementTypeKey } from "../items/UserAchievement";
import { Client, MessageEmbed, User } from "discord.js";
import { AchievementConfigBase } from "../config/AchievementConfigBase";

export type UserAchievementNotificationType = 'DM'
export class UserAchievementConfig extends AchievementConfigBase {
    constructor(notificationType: UserAchievementNotificationType) {
        super();
        this.notificationType = notificationType;
    }

    public notificationType: UserAchievementNotificationType;
    public achievements: UserAchievement<UserAchievementTypeKey>[];

    public async notify<Type extends UserAchievementTypeKey>(client: Client, achiever: User, achievement: UserAchievement<Type>) {
        return super._notify<'USER'>(client, achievement, (percentage => new MessageEmbed()
            .setTitle(`üèÜ Achievement Unlocked! üèÜ\n${achievement.name}`)
            .setDescription("```\n" + achievement.description + "\n```")
            .setFooter(`You're one of the ${percentage.value}% of people who have achieved this!`)
            .setTimestamp(Date.now())
            .setThumbnail(achiever.avatarURL())
        ), await achiever.createDM());
    }
}